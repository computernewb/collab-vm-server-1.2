name: CollabVM Server

on: [ push, pull_request ]

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        os: [ ubuntu-latest ]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v1
        with:
          submodules: true

      - name: Install Dependencies And Setup LLVM
        id: depends-n-llvm
        run: |
         sudo apt install -y libvncserver-dev libboost-dev libboost-system-dev libboost-filesystem-dev libboost-program-options-dev libspdlog-dev libfmt-dev cmake ninja-build
         sudo bash -c "$(wget -O - https://apt.llvm.org/llvm.sh) 14"
        shell: bash

      - name: Build
        id: build
        run: |
          cmake -B build -GNinja -DCMAKE_BUILD_TYPE=Release -DCMAKE_C_COMPILER=clang-14 -DCMAKE_CXX_COMPILER=clang++-14
          cmake --build build
        shell: bash